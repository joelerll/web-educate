webpackJsonp([1],{0:function(e,t){},"7zck":function(e,t){},"EJR+":function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("7+uW"),o=a("3EgV"),n=a.n(o),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-app",{attrs:{id:"app"}},[t("main",[t("router-view")],1)])},staticRenderFns:[]};var i=a("VU/8")({name:"App"},s,!1,function(e){a("a9d6")},null,null).exports,c=a("/ocq"),l={data:function(){return{valid:!1,snackbar:!1,usuario:"",usuarioRules:[function(e){return!!e||"Usuario es requerido"}],clave:"",claveRules:[function(e){return!!e||"Clave es requerida"}]}},methods:{submit:function(){var e=this,t=this.usuario,a=this.clave;this.$store.dispatch("Login",{usuario:t,clave:a}).then(function(t){var a=e.$store.getters.esAdmin;t?a?R.push("usuarios"):R.push("subir"):e.snackbar=!0})}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{"padding-top":"10%"},attrs:{id:"login"}},[r("v-layout",{attrs:{"align-center":"","justify-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{dark:"",color:"primary"}},[r("v-toolbar-title",[e._v("Fundación Edúcate")]),e._v(" "),r("v-spacer")],1),e._v(" "),r("v-card-media",{attrs:{height:"100px"}},[r("img",{attrs:{src:a("hnG6")}})]),e._v(" "),r("v-card-text",[r("v-form",{model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[r("v-text-field",{attrs:{"prepend-icon":"person",name:"Usuario",label:"Usuario",rules:e.usuarioRules},on:{keyup:function(t){return"button"in t||13===t.keyCode?e.submit(t):null}},model:{value:e.usuario,callback:function(t){e.usuario=t},expression:"usuario"}}),e._v(" "),r("v-text-field",{attrs:{"prepend-icon":"lock",name:"Clave",label:"Clave",type:"password",rules:e.claveRules},on:{keyup:function(t){return"button"in t||13===t.keyCode?e.submit(t):null}},model:{value:e.clave,callback:function(t){e.clave=t},expression:"clave"}})],1),e._v(" "),r("v-btn",{attrs:{block:"",disabled:!e.valid,color:"primary",large:""},on:{click:e.submit}},[e._v("\n              Entrar\n        ")])],1)],1)],1)],1),e._v(" "),r("v-snackbar",{attrs:{color:"red"},model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n      El usuario no esta autorizado o clave no existe\n    "),r("v-btn",{attrs:{color:"white",flat:""},on:{click:function(t){e.snackbar=!1}}},[e._v("\n      Close\n    ")])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(l,u,!1,function(e){a("hZmZ")},null,null).exports,v=a("BO1k"),f=a.n(v),p=a("ZtGN"),b=(a("Wht6"),a("wxlT")),m=a.n(b),g={data:function(){return{files:[],snackbar:!1,snackbarError:!1,codigo:"",mensajeError:"",desaparecer:!1,timeout:1e4}},computed:{usuario:function(){return this.$store.getters.obtenerUsuario},codigos:function(){var e=this.$store.getters.obtenerUsuario.codigos.split(",");return e}},mounted:function(){p.registerPlugin(m.a)},watch:{codigo:function(e,t){var a=this,r=document.createElement("input");r.setAttribute("type","file"),r.setAttribute("class","filepond archivo"),r.setAttribute("name","archivo");var o=document.getElementById("carta");document.getElementsByClassName("archivo")[0].remove(),o.appendChild(r),this.desaparecer=!0;var n=this.$store.getters.obtenerUsuario.codigoEscuela;this.desaparecer=!1,p.setOptions(),p.setOptions({server:{url:"./api/archivo",timeout:4e4,process:{headers:{cod_escuela:n,cod_anio:this.codigo},onerror:function(e){var t=JSON.parse(e);return t.estado||(a.snackbarError=!0,a.mensajeError=t.mensaje),JSON.parse(e)}}}});var s=!0,i=!1,c=void 0;try{for(var l,u=f()(document.querySelectorAll(".archivo"));!(s=(l=u.next()).done);s=!0){var d=l.value;p.create(d,{labelIdle:'Subir archivo... <span class="filepond--label-action">Buscar</span>',labelFileLoading:"Subiendo",labelFileProcessing:"Subiendo",labelFileTypeNotAllowed:"El tipo de archivo no es válido",labelFileProcessingError:"No se pudo subir el archivo",fileValidateTypeLabelExpectedTypes:"Se espera xml",labelFileProcessingComplete:"Completada",labelTapToCancel:"Toque para cancelar",labelTapToUndo:"Toque para eliminar",labelTapToRetry:"Toque para reintentar",acceptedFileTypes:["text/xml"]})}}catch(e){i=!0,c=e}finally{try{!s&&u.return&&u.return()}finally{if(i)throw c}}var v=!0,b=!1,m=void 0;try{for(var g,h=f()(document.querySelectorAll(".archivo"));!(v=(g=h.next()).done);v=!0){var k=g.value;k.addEventListener("FilePond:addfile",function(e){}),k.addEventListener("FilePond:addfilestart",function(e){}),k.addEventListener("FilePond:processfile",function(e){e.detail.error||(a.snackbar=!0)})}}catch(e){b=!0,m=e}finally{try{!v&&h.return&&h.return()}finally{if(b)throw m}}}},methods:{loadTextFromFile:function(e){var t=this;reader.onload=function(e){t.$store.dispatch("Enviar",x).then(function(){t.snackbar=!0})}},salir:function(){var e=this;this.$store.dispatch("Logout").then(function(t){e.$router.push("/")})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-toolbar-title",[e._v("Fundación Edúcate")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[a("v-btn",{attrs:{flat:""},on:{click:e.salir}},[a("v-icon",{attrs:{left:""}},[e._v("logout")]),e._v("Salir")],1)],1)],1),e._v(" "),a("div",{staticStyle:{"padding-top":"10%"}},[a("h2",{staticClass:"title"},[e._v("Usuario: ")]),e._v(" "),a("h1",{staticClass:"title"},[e._v(e._s(e.usuario.usuario))]),e._v(" "),a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-select",{attrs:{items:e.codigos,box:"",label:"Escoger código"},model:{value:e.codigo,callback:function(t){e.codigo=t},expression:"codigo"}})],1)],1),e._v(" "),a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("v-card",{directives:[{name:"show",rawName:"v-show",value:""!=e.codigo&&0==e.desaparecer,expression:"codigo != '' && desaparecer == false"}],staticClass:"elevation-12"},[a("v-toolbar",{attrs:{dark:"",color:"primary"}},[a("v-toolbar-title",[e._v("Subir Archivo")]),e._v(" "),a("v-spacer")],1),e._v(" "),a("v-card-text",{attrs:{id:"carta"}},[a("input",{staticClass:"filepond archivo",attrs:{type:"file",name:"archivo"}})])],1)],1)],1),e._v(" "),a("v-snackbar",{model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n        Enviado Correctamente\n      "),a("v-btn",{attrs:{color:"green",flat:""},on:{click:function(t){e.snackbar=!1}}},[e._v("\n        Close\n      ")])],1),e._v(" "),a("v-snackbar",{attrs:{timeout:e.timeout},model:{value:e.snackbarError,callback:function(t){e.snackbarError=t},expression:"snackbarError"}},[e._v("\n        "+e._s(e.mensajeError)+"\n      "),a("v-btn",{attrs:{color:"red",flat:""},on:{click:function(t){e.snackbarError=!1}}},[e._v("\n        Close\n      ")])],1)],1)],1)},staticRenderFns:[]};var k=a("VU/8")(g,h,!1,function(e){a("EJR+")},null,null).exports,E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-toolbar",[a("v-toolbar-title",[e._v("Fundación Edúcate")]),e._v(" "),a("v-spacer"),e._v(" "),a("v-toolbar-items",{staticClass:"hidden-sm-and-down"},[a("v-btn",{attrs:{flat:""},on:{click:e.salir}},[a("v-icon",{attrs:{left:""}},[e._v("logout")]),e._v("Salir")],1)],1)],1),e._v(" "),a("div",{staticStyle:{"padding-top":"10%"}},[a("v-layout",{attrs:{"align-center":"","justify-center":""}},[a("v-flex",{attrs:{xs12:"",sm8:"",md4:""}},[a("form",{on:{submit:function(e){e.preventDefault()}}},[a("v-text-field",{attrs:{label:"Nombre",required:"",rules:e.nombreRules},model:{value:e.nombre,callback:function(t){e.nombre=t},expression:"nombre"}}),e._v(" "),a("v-text-field",{attrs:{label:"Usuario",required:"",rules:e.usuarioRules},model:{value:e.usuario,callback:function(t){e.usuario=t},expression:"usuario"}}),e._v(" "),a("v-text-field",{attrs:{label:"Clave",rules:e.claveRules,required:""},model:{value:e.clave,callback:function(t){e.clave=t},expression:"clave"}}),e._v(" "),a("v-select",{attrs:{items:e.escuelas,"item-text":"tipo","item-value":"tipo",box:"",label:"Escoger la escuela",required:""},model:{value:e.codigoEscuela,callback:function(t){e.codigoEscuela=t},expression:"codigoEscuela"}}),e._v(" "),a("v-select",{attrs:{items:e.perfiles,"item-text":"tipo","item-value":"id",box:"",label:"Escoger tipo usuario",required:""},model:{value:e.perfil,callback:function(t){e.perfil=t},expression:"perfil"}}),e._v(" "),a("v-btn",{attrs:{color:"success",disabled:""==e.nombre||""==e.usuario||""==e.codigoEscuela||""==e.perfil||e.clave.length<5},on:{click:e.crear}},[e._v("Crear")])],1)])],1)],1),e._v(" "),a("v-snackbar",{model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[e._v("\n        Creado Correctamente\n      "),a("v-btn",{attrs:{color:"green",flat:""},on:{click:function(t){e.snackbar=!1}}},[e._v("\n        Close\n      ")])],1),e._v(" "),a("v-snackbar",{attrs:{timeout:e.timeout},model:{value:e.snackbarError,callback:function(t){e.snackbarError=t},expression:"snackbarError"}},[e._v("\n      "+e._s(e.mensajeError)+"\n    "),a("v-btn",{attrs:{color:"red",flat:""},on:{click:function(t){e.snackbarError=!1}}},[e._v("\n      Close\n    ")])],1)],1)},staticRenderFns:[]};var _=a("VU/8")({data:function(){return{clave:"",codigoEscuela:"",usuario:"",snackbar:"",nombre:"",mensajeError:"",snackbarError:!1,timeout:1e4,perfil:"",usuarioRules:[function(e){return!!e||"Usuario es requerido"}],nombreRules:[function(e){return!!e||"Nombre es requerido"}],claveRules:[function(e){return(e||"").length>5||"Clave debe ser de tamaño mayor o igual a 5"}]}},computed:{codigos:function(){var e=this.$store.getters.obtenerUsuario.codigos.split(",");return e},escuelas:function(){return this.$store.getters.ObtenerEscuelas},perfiles:function(){return this.$store.getters.ObtenerPerfiles}},methods:{salir:function(){var e=this;this.$store.dispatch("Logout").then(function(t){e.$router.push("/")})},crear:function(){var e=this,t={codigoEscuela:this.codigoEscuela,nombre:this.nombre,usuario:this.usuario,perfil:this.perfil,clave:this.clave};this.$store.dispatch("UsuarioCrear",t).then(function(t){t?(e.snackbar=!0,e.codigoEscuela="",e.nombre="",e.usuario="",e.perfil="",e.clave=""):(e.snackbarError=!0,e.mensajeError="Persona con ese usuario ya existe")}).catch(function(t){e.snackbarError=!0,e.mensajeError="Persona con ese usuario ya existe"})}}},E,!1,function(e){a("goKG")},null,null).exports,y=a("NYxO"),C=a("8+8L"),w=a("//Fk"),L=a.n(w),U={Login:function(e,t){var a=e.commit,o=(e.dispatch,t.usuario),n=t.clave;return new L.a(function(e,t){r.a.http.post("/api/login",{usuario:o,clave:n}).then(function(t){t.body.estado?(console.log(t.body.datos),a("setUsuario",t.body.datos),a("setLoggeado"),e(!0)):e(!1)}).catch(function(e){t(e)})})},Enviar:function(e,t){e.commit,e.dispatch;return new L.a(function(e,t){e(!0)})},EstaLogeado:function(e){var t=e.commit;e.dispatch;return new L.a(function(e,a){r.a.http.get("/api/estaLogueado").then(function(a){a.body.estado?(t("setLoggeado"),e(a.body.datos)):e(!1)}).catch(function(e){a(e)})})},Logout:function(e){e.commit,e.dispatch;return new L.a(function(e,t){r.a.http.get("/api/logout").then(function(t){t.body.estado?e(!0):e(!1)}).catch(function(e){t(e)})})},UsuarioCrear:function(e,t){e.commit,e.dispatch;return new L.a(function(e,a){r.a.http.post("/api/usuarios",t).then(function(t){t.body.estado?e(!0):e(!1)}).catch(function(e){a(e)})})}},F={estaLoggeado:function(e){return e.estaLoggeado},obtenerUsuario:function(e){return{usuario:e.usuario,codigo:e.codigo,escuela:e.escuela,id:e.id,codigos:e.codigos,codigoEscuela:e.codigoEscuela}},esAdmin:function(e){return 1==e.perfilId},ObtenerEscuelas:function(e){return console.log(e.escuelas),e.escuelas},ObtenerPerfiles:function(e){return e.perfiles}};r.a.use(y.a),r.a.use(C.a);var $=new y.a.Store({state:{estaLoggeado:!1,usuario:"",codigo:"",escuela:"",id:"",codigos:[],codigoEscuela:"",perfilId:"",perfil:"",perfiles:[],escuelas:[]},mutations:{setUsuario:function(e,t){var a=t.codigo,r=t.escuela,o=t.id,n=t.nombre,s=t.codigos,i=t.codigoEscuela,c=t.perfilId,l=t.perfil,u=t.perfiles,d=t.escuelas;e.usuario=n,e.codigo=a,e.escuela=r,e.id=o,e.codigos=s,e.codigoEscuela=i,e.perfilId=c,e.perfil=l,e.perfiles=u,e.escuelas=d},setLoggeado:function(e){e.estaLoggeado=!0}},actions:U,getters:F});r.a.use(c.a);var R=new c.a({routes:[{path:"/",name:"Login",component:d},{path:"/subir",name:"Subir",component:k},{path:"/usuarios",name:"Usuario",component:_}]});R.beforeEach(function(e,t,a){var r=e.path,o=$.getters.esAdmin;"/usuarios"!==r||void 0===o||o?"/"===r?a():$.dispatch("EstaLogeado").then(function(e){e?($.commit("setUsuario",e),a()):a("/")}):a("/subir")});a("7zck");r.a.config.productionTip=!1,r.a.use(n.a,{theme:{primary:"#0c9fd3"}}),new r.a({el:"#app",router:R,store:$,components:{App:i},template:"<App/>"})},Wht6:function(e,t){},a9d6:function(e,t){},goKG:function(e,t){},hZmZ:function(e,t){},hnG6:function(e,t,a){e.exports=a.p+"static/img/logoe.261cf7c.jpg"}},["NHnr"]);
//# sourceMappingURL=app.a9fb46fcdb103811e237.js.map